pipeline {
    agent any // selection of agents
    //defining environment variables
    environment {
        SONAR_HOME = 'C:\\Users\\Administrator\\Documents\\tools\\sonar-scanner\\bin'
        REPO_NAME = 'https://github.com/Krithi752/html-sample-app-krithika.git'
        BRANCH_NAME = 'master'
    }

     stages {
        // stage1
        stage('testing and verify of required  commands') {
            steps {
                echo 'Hello World'
                 // bat or pwsh
                bat """
                %SONAR_HOME%\\sonar-scanner --version
                echo == checking docker ===>
                docker version 
                echo ==> java version ==>
                java --version 
                """
            }
        }
        // git checkout 
        stage('taking code of github repo'){
            steps {
                echo 'clone repo to project'
                git url: "${REPO_NAME}", branch: "${BRANCH_NAME}"
            }
        }
        stage('sast with sonar-scanner'){
            steps {
                echo 'wait for sonarscanner to finish'
                bat """
                %SONAR_HOME%\\sonar-scanner\
                -D"sonar.projectKey=krithika_day3" \
                -D"sonar.sources=." -D"sonar.host.url=http://13.203.151.240:9000" \
                -D"sonar.token=sqp_ff23f7784d03695be0a1ea9d3f55523659f6ee7c"
            }
        }
     
    }
}